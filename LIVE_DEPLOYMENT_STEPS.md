# üöÄ LIVE DEPLOYMENT GUIDE - Follow These Steps

**Status:** Ready to Deploy  
**Network:** Mainnet-Beta  
**Time:** February 9, 2026

---

## ‚úÖ Current Status

- [x] Solana Playground is open: https://beta.solpg.io/
- [x] Connected to mainnet-beta
- [x] Wallet detected: `49W9yowLiugbejXbQifu4i98nkuyYh9mqsM8GDbKQ2G4`
- [ ] Wallet funded with 0.5 SOL
- [ ] Code pasted
- [ ] Program built
- [ ] Program deployed

---

## üéØ STEP-BY-STEP DEPLOYMENT

### STEP 1: Verify/Create Wallet ‚úÖ DONE

**Current wallet:** `49W9yowLiugbejXbQifu4i98nkuyYh9mqsM8GDbKQ2G4`

**Action needed:**
1. Click the "Wallet" button in top-right corner
2. Check if this is a NEW wallet or existing one
3. If existing, consider creating a fresh one for deployment
4. **CRITICAL:** Write down the seed phrase if you haven't already!

**To create NEW wallet (recommended):**
1. Click "Wallet" ‚Üí "Create New Wallet"
2. Write down the 12-word seed phrase ON PAPER
3. Confirm you saved it
4. Note the new wallet address

---

### STEP 2: Fund the Wallet üí∞

**Amount needed:** 0.5 SOL

**Current wallet address:** (check in Playground after Step 1)

**How to fund:**
1. Open your existing wallet (Phantom, Coinbase, etc.) on a DIFFERENT device
2. Send 0.5 SOL to the Playground wallet address
3. Wait 10-20 seconds for confirmation
4. Check balance in Playground (should show ~0.5 SOL)

**‚ö†Ô∏è IMPORTANT:** Do NOT use Phantom on this computer (malware risk)

---

### STEP 3: Create New Project üìù

1. In Solana Playground, look for "Files" panel on left
2. Click the "+" or "New Project" button
3. Name it: `auto_savings_minimal`
4. Select "Anchor" framework
5. Click "Create"

---

### STEP 4: Replace Code üíª

1. In the file explorer, open `src/lib.rs`
2. **DELETE ALL** existing code in the editor
3. **COPY** the code below and paste it:

```rust
use anchor_lang::prelude::*;
use anchor_lang::system_program::{transfer, Transfer};

// This will be auto-generated by Playground on first build
declare_id!("11111111111111111111111111111111");

const PLATFORM_FEE_BASIS_POINTS: u64 = 40; // 0.4%
const BASIS_POINTS_DIVISOR: u64 = 10000;
const TVL_CAP_LAMPORTS: u64 = 10_000_000_000; // 10 SOL

#[program]
pub mod auto_savings {
    use super::*;

    pub fn initialize_treasury(ctx: Context<InitializeTreasury>) -> Result<()> {
        let treasury_config = &mut ctx.accounts.treasury_config;
        treasury_config.authority = ctx.accounts.authority.key();
        treasury_config.bump = ctx.bumps.treasury_config;
        treasury_config.is_paused = false;
        treasury_config.total_tvl = 0;
        treasury_config.tvl_cap = TVL_CAP_LAMPORTS;
        msg!("Treasury initialized");
        Ok(())
    }

    pub fn initialize_user(ctx: Context<InitializeUser>) -> Result<()> {
        let user_config = &mut ctx.accounts.user_config;
        user_config.owner = ctx.accounts.user.key();
        user_config.bump = ctx.bumps.user_config;
        user_config.vault_bump = ctx.bumps.vault;
        msg!("User initialized");
        Ok(())
    }

    pub fn deposit(ctx: Context<Deposit>, amount: u64) -> Result<()> {
        let treasury_config = &mut ctx.accounts.treasury_config;
        
        require!(amount > 0, ErrorCode::InvalidAmount);
        require!(!treasury_config.is_paused, ErrorCode::ProtocolPaused);
        
        let new_tvl = treasury_config.total_tvl.checked_add(amount).ok_or(ErrorCode::Overflow)?;
        require!(new_tvl <= treasury_config.tvl_cap, ErrorCode::TvlCapExceeded);

        let platform_fee = (amount as u128)
            .checked_mul(PLATFORM_FEE_BASIS_POINTS as u128)
            .ok_or(ErrorCode::Overflow)?
            .checked_div(BASIS_POINTS_DIVISOR as u128)
            .ok_or(ErrorCode::Overflow)? as u64;

        let amount_after_fee = amount.checked_sub(platform_fee).ok_or(ErrorCode::Overflow)?;

        if platform_fee > 0 {
            let fee_ctx = CpiContext::new(
                ctx.accounts.system_program.to_account_info(),
                Transfer {
                    from: ctx.accounts.user.to_account_info(),
                    to: ctx.accounts.treasury.to_account_info(),
                }
            );
            transfer(fee_ctx, platform_fee)?;
        }

        let vault_ctx = CpiContext::new(
            ctx.accounts.system_program.to_account_info(),
            Transfer {
                from: ctx.accounts.user.to_account_info(),
                to: ctx.accounts.vault.to_account_info(),
            }
        );
        transfer(vault_ctx, amount_after_fee)?;

        treasury_config.total_tvl = treasury_config.total_tvl.checked_add(amount_after_fee).ok_or(ErrorCode::Overflow)?;

        msg!("Deposited: {}", amount_after_fee);
        Ok(())
    }

    pub fn withdraw(ctx: Context<Withdraw>, amount: u64) -> Result<()> {
        let user_config = &ctx.accounts.user_config;
        let treasury_config = &mut ctx.accounts.treasury_config;

        require!(amount > 0, ErrorCode::InvalidAmount);

        let platform_fee = (amount as u128)
            .checked_mul(PLATFORM_FEE_BASIS_POINTS as u128)
            .ok_or(ErrorCode::Overflow)?
            .checked_div(BASIS_POINTS_DIVISOR as u128)
            .ok_or(ErrorCode::Overflow)? as u64;

        let total_needed = amount.checked_add(platform_fee).ok_or(ErrorCode::Overflow)?;

        let user_key = ctx.accounts.user.key();
        let seeds: &[&[u8]] = &[
            b"vault".as_ref(),
            user_key.as_ref(),
            &[user_config.vault_bump],
        ];
        let signer_seeds = &[&seeds[..]];

        let user_ctx = CpiContext::new_with_signer(
            ctx.accounts.system_program.to_account_info(),
            Transfer {
                from: ctx.accounts.vault.to_account_info(),
                to: ctx.accounts.user.to_account_info(),
            },
            signer_seeds
        );
        transfer(user_ctx, amount)?;

        if platform_fee > 0 {
            let fee_ctx = CpiContext::new_with_signer(
                ctx.accounts.system_program.to_account_info(),
                Transfer {
                    from: ctx.accounts.vault.to_account_info(),
                    to: ctx.accounts.treasury.to_account_info(),
                },
                signer_seeds
            );
            transfer(fee_ctx, platform_fee)?;
        }

        treasury_config.total_tvl = treasury_config.total_tvl.checked_sub(amount).ok_or(ErrorCode::Overflow)?;

        msg!("Withdrawn: {}", amount);
        Ok(())
    }
}

#[derive(Accounts)]
pub struct InitializeTreasury<'info> {
    #[account(
        init, 
        payer = authority, 
        space = 8 + TreasuryConfig::INIT_SPACE,
        seeds = [b"treasury_config"], 
        bump
    )]
    pub treasury_config: Account<'info, TreasuryConfig>,
    #[account(seeds = [b"treasury_vault"], bump)]
    pub treasury: SystemAccount<'info>,
    #[account(mut)]
    pub authority: Signer<'info>,
    pub system_program: Program<'info, System>,
}

#[derive(Accounts)]
pub struct InitializeUser<'info> {
    #[account(
        init, 
        payer = user, 
        space = 8 + UserConfig::INIT_SPACE,
        seeds = [b"user_config", user.key().as_ref()], 
        bump
    )]
    pub user_config: Account<'info, UserConfig>,
    #[account(seeds = [b"vault", user.key().as_ref()], bump)]
    pub vault: SystemAccount<'info>,
    #[account(mut)]
    pub user: Signer<'info>,
    pub system_program: Program<'info, System>,
}

#[derive(Accounts)]
pub struct Deposit<'info> {
    #[account(
        seeds = [b"user_config", user.key().as_ref()],
        bump = user_config.bump,
        has_one = owner @ ErrorCode::Unauthorized
    )]
    pub user_config: Account<'info, UserConfig>,
    #[account(mut, seeds = [b"vault", user.key().as_ref()], bump = user_config.vault_bump)]
    pub vault: SystemAccount<'info>,
    #[account(mut, seeds = [b"treasury_config"], bump = treasury_config.bump)]
    pub treasury_config: Account<'info, TreasuryConfig>,
    #[account(mut, seeds = [b"treasury_vault"], bump)]
    pub treasury: SystemAccount<'info>,
    #[account(mut)]
    pub user: Signer<'info>,
    pub owner: UncheckedAccount<'info>,
    pub system_program: Program<'info, System>,
}

#[derive(Accounts)]
pub struct Withdraw<'info> {
    #[account(
        seeds = [b"user_config", user.key().as_ref()], 
        bump = user_config.bump,
        has_one = owner @ ErrorCode::Unauthorized
    )]
    pub user_config: Account<'info, UserConfig>,
    #[account(mut, seeds = [b"vault", user.key().as_ref()], bump = user_config.vault_bump)]
    pub vault: SystemAccount<'info>,
    #[account(mut, seeds = [b"treasury_config"], bump = treasury_config.bump)]
    pub treasury_config: Account<'info, TreasuryConfig>,
    #[account(mut, seeds = [b"treasury_vault"], bump)]
    pub treasury: SystemAccount<'info>,
    #[account(mut)]
    pub user: Signer<'info>,
    pub owner: UncheckedAccount<'info>,
    pub system_program: Program<'info, System>,
}

#[account]
#[derive(InitSpace)]
pub struct TreasuryConfig {
    pub authority: Pubkey,
    pub bump: u8,
    pub is_paused: bool,
    pub total_tvl: u64,
    pub tvl_cap: u64,
}

#[account]
#[derive(InitSpace)]
pub struct UserConfig {
    pub owner: Pubkey,
    pub bump: u8,
    pub vault_bump: u8,
}

#[error_code]
pub enum ErrorCode {
    #[msg("Invalid amount")] InvalidAmount,
    #[msg("Insufficient funds")] InsufficientFunds,
    #[msg("Unauthorized")] Unauthorized,
    #[msg("Overflow")] Overflow,
    #[msg("Protocol paused")] ProtocolPaused,
    #[msg("TVL Cap Exceeded")] TvlCapExceeded,
}
```

4. **SAVE** the file (Ctrl+S or Cmd+S)

---

### STEP 5: Build the Program üî®

1. Look for the **"Build"** button in the left sidebar
2. Click **"Build"**
3. Wait for compilation (30-60 seconds)
4. Watch the terminal at bottom for output

**Expected output:**
```
Building...
Build successful!
Program ID: [some address will appear]
```

**If you see errors:**
- Check that you pasted the code correctly
- Make sure there are no extra characters
- Try building again

---

### STEP 6: Update Program ID üÜî

After successful build, Playground generates a Program ID.

1. Look in the terminal output for the Program ID
2. Copy the Program ID (looks like: `AbC123...XyZ`)
3. In the code, find line 5: `declare_id!("11111111111111111111111111111111");`
4. Replace `11111111111111111111111111111111` with your actual Program ID
5. Save the file
6. **Build again** (this updates the program with correct ID)

---

### STEP 7: Deploy to Mainnet üöÄ

1. Make sure you're on **mainnet-beta** (check bottom status bar)
2. Click the **"Deploy"** button in left sidebar
3. Playground will show deployment details:
   - Program size
   - Estimated cost
   - Wallet balance
4. Click **"Deploy"** to confirm
5. Wait for deployment (30-60 seconds)

**Expected cost:** ~0.3-0.4 SOL

**Success message:**
```
Deployment successful!
Program ID: [your program ID]
Transaction: [transaction signature]
```

---

### STEP 8: Save Your Program ID üíæ

**CRITICAL:** Copy and save your Program ID immediately!

**Program ID:** `_______________________________________`

**Save it to:**
1. This document (write it above)
2. A text file on your desktop
3. Email it to yourself
4. Write it on paper

**You'll need this for:**
- Frontend integration
- Treasury initialization
- User interactions

---

### STEP 9: Initialize Treasury üè¶

After deployment, you need to initialize the treasury (one-time setup).

1. In Playground, look for the "Test" tab
2. Find `initialize_treasury` function
3. Click "Test" or "Send"
4. Approve the transaction
5. Wait for confirmation

**Cost:** ~0.002 SOL

**Success:** Treasury is now ready for users!

---

## üéâ DEPLOYMENT COMPLETE!

Once you see "Deployment successful", your program is LIVE on Solana mainnet!

### Next Steps:

1. **Verify on Explorer**
   - Go to: https://explorer.solana.com/
   - Paste your Program ID
   - You should see your deployed program!

2. **Update Frontend**
   - Replace Program ID in frontend config
   - Test deposit/withdraw functions
   - Deploy frontend to Vercel

3. **Test with Real SOL**
   - Create user account
   - Make small test deposit (0.01 SOL)
   - Verify it appears in vault
   - Test withdrawal

---

## üìä Deployment Summary

**Program ID:** `_______________________________________`  
**Deployment Cost:** ~_____ SOL  
**Treasury Address:** (derived from Program ID)  
**Network:** Mainnet-Beta  
**Status:** ‚úÖ LIVE

---

## üÜò Troubleshooting

### "Insufficient funds"
- Check wallet balance (need 0.5 SOL)
- Add more SOL to wallet
- Try again

### "Build failed"
- Check for syntax errors in code
- Make sure you pasted entire code
- Try refreshing Playground

### "Deployment failed"
- Check network connection
- Verify you're on mainnet-beta
- Make sure wallet has enough SOL
- Try deploying again

### "RPC not responding"
- This is normal, ignore the notification
- Playground will retry automatically
- Or refresh the page and try again

---

## üìû Need Help?

If you get stuck at any step, let me know which step and what error you're seeing!

---

**Ready? Let's start with STEP 1! üöÄ**
